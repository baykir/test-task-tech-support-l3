# test-task-tech-support-l3
Репозиторий выполнения тестового задания "Test task TechSup L3"

## Запуск скрипта
Перед выполнением скрипта рекомендуется проверить признак выполняемости с помощь команды:
```bash
stat services.sh
```
Если признак отсутствует, добавить командой
```bash
chmod 744 services.sh
```
Запустить скрипт командой
```bash
/path/to/bash services.sh <server_name>
```
По умолчанию путь до интерпретатора bash - `/bin/bash`. В случае если отличается от стандартного, то потребуется скорректировать первую строку скрипт после символа шебанг (`#!`) на свой путь до интерпретатора.

В качестве аргумента `<server_name>` указать имя сервера. Если не указано - будет присвоено имя `DEFAULT`.

## Описание скрипта
Данный скрипт выполняется следующим образом:
1. Скачивает данные из репозитория [Git](https://raw.githubusercontent.com/GreatMedivack/files/master/list.out) и сохраняет во временный файл `data`
2. Создается файл и с помощью `awk` отфильтровываются имена нерабочих подов, сохраняются в файл.
3. Создаётся файл и с помощью `awk` отфильтровываются имена рабочих подов и сохраняются в файл
4. В созданных на п.2 и п.3 данные нормализуются, построчно удаляются постфиксы с помощью потокового редактора `sed`.
5. Создаётся файл отчёта куда в сводном виде поступает информацию из файлов п.2 и п.3
6. Проверяется наличие директории `archives` и если такой нет - создаётся
> Дополнительно добавил этот функционал, так как в "стерильных" директориях каждый раз приходилось вручную её создавать.
7. Поиск ранее сформированного отчёта в `archives`. Если нет - формирование и перенос в директорию `archives`.
8. Удаление временных файлов.
9. Проверка архива на целостность и вывод результата проверки.

## ToDo
1. Параметризировать источник получения данных, например передавать его при вызове скрипта
2. Проверку целостности выполнять:
    - для ранее созданного отчёта до этапа удаления временных файлов
    - для нового отчёта до переноса в директорию `archives`